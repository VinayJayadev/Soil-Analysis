2025-07-14 00:56:28,756 - pipeline - INFO - Pipeline started - Run ID: pipeline_20250714_005628
2025-07-14 00:56:28,756 - pipeline - INFO - Start time: 2025-07-14 00:56:28
2025-07-14 00:56:28,756 - pipeline - INFO - Pipeline initialized with run ID: pipeline_20250714_005628
2025-07-14 00:56:28,756 - pipeline - INFO - Starting geospatial soil analysis pipeline
2025-07-14 00:56:28,756 - pipeline - INFO - Configuration: {'data_file': 'data/eu_wosis_points.fgb', 'db_path': 'data/db/soil_analysis.db', 'output_dir': 'output', 'sampling_method': 'single_cluster', 'sample_size': 50, 'min_samples_per_country': 10, 'min_clusters': 2, 'max_clusters': 10, 'min_samples_per_cluster': 5, 'country_codes': None}
2025-07-14 00:56:28,756 - pipeline - INFO - Stage 1: Database Initialization
2025-07-14 00:56:28,756 - pipeline - INFO - Stage: Database Initialization - Creating database schema
2025-07-14 00:56:28,756 - pipeline - DEBUG - Stage 'Database Initialization' started at 00:56:28
2025-07-14 00:56:28,766 - pipeline - INFO - Database tables created successfully
2025-07-14 00:56:28,766 - pipeline - INFO - Database indexes created successfully
2025-07-14 00:56:28,766 - pipeline - INFO - Stage completed: Database Initialization (0.0s) - database: data\db\soil_analysis.db
2025-07-14 00:56:28,766 - pipeline - INFO - Database already exists with data. Clearing for fresh run...
2025-07-14 00:56:28,766 - pipeline - INFO - Clearing existing database data...
2025-07-14 00:56:28,771 - pipeline - INFO - Cleared soil_samples table
2025-07-14 00:56:28,772 - pipeline - INFO - Cleared countries table
2025-07-14 00:56:28,772 - pipeline - INFO - Cleared clusters table
2025-07-14 00:56:28,773 - pipeline - INFO - Cleared analysis_results table
2025-07-14 00:56:28,773 - pipeline - INFO - Cleared pipeline_logs table
2025-07-14 00:56:28,773 - pipeline - ERROR - Error clearing database: no such table: sqlite_sequence
2025-07-14 00:56:28,773 - pipeline - INFO - Database initialized successfully
2025-07-14 00:56:28,774 - pipeline - INFO - Stage 2: Data Loading
2025-07-14 00:56:28,774 - pipeline - INFO - Stage: Data Loading - Loading soil samples from data/eu_wosis_points.fgb
2025-07-14 00:56:28,775 - pipeline - DEBUG - Stage 'Data Loading' started at 00:56:28
2025-07-14 00:56:28,775 - pipeline - DEBUG - Loading soil samples from: data/eu_wosis_points.fgb
2025-07-14 00:56:29,861 - pipeline - DEBUG - Set CRS to EPSG:4326
2025-07-14 00:56:29,861 - pipeline - DEBUG - Parsing SOC% values from JSON format
2025-07-14 00:56:29,881 - pipeline - DEBUG - Estimating clay fraction based on SOC%
2025-07-14 00:56:29,883 - pipeline - DEBUG - Validating data quality
2025-07-14 00:56:29,885 - pipeline - WARNING - Found missing values: {'raw_data_id': 0, 'latitude': 0, 'longitude': 0, 'soc_percent': 0, 'soc_method': 0, 'top_depth_cm': 0, 'bottom_depth_cm': 0, 'sampling_date': 0, 'lab_analysis_date': 7012, 'clay_fraction': 0}
2025-07-14 00:56:29,885 - pipeline - DEBUG - Data validation completed
2025-07-14 00:56:29,885 - pipeline - INFO - Loaded 7,012 soil samples
2025-07-14 00:56:29,885 - pipeline - INFO - Successfully parsed 7,012 SOC% values
2025-07-14 00:56:29,891 - pipeline - INFO - SOC% range: 0.000% - 66.560%
2025-07-14 00:56:29,892 - pipeline - INFO - Mean SOC%: 1.688%
2025-07-14 00:56:29,896 - pipeline - INFO - Clay fraction range: 0.150 - 0.350
2025-07-14 00:56:29,896 - pipeline - INFO - Mean clay fraction: 0.186
2025-07-14 00:56:30,208 - pipeline - INFO - Loaded 7,012 records into soil_samples in 0.31s
2025-07-14 00:56:30,208 - pipeline - INFO - Stage completed: Data Loading (1.4s) - records: 7,012, duration: 1.4s, file: eu_wosis_points.fgb
2025-07-14 00:56:30,208 - pipeline - INFO - PERFORMANCE - Data Loading: 1433.87ms - records: 7,012, duration: 1.4s, file: eu_wosis_points.fgb
2025-07-14 00:56:30,208 - pipeline - INFO - Loaded 7012 soil samples
2025-07-14 00:56:30,243 - pipeline - ERROR - Error checking data imbalance: index 0 is out of bounds for axis 0 with size 0
2025-07-14 00:56:30,244 - pipeline - INFO - Stage 3: Overpass API Integration
2025-07-14 00:56:30,244 - pipeline - INFO - Starting country boundaries fetch from Overpass API
2025-07-14 00:56:30,244 - pipeline - DEBUG - Overpass query: [out:json][timeout:300];
(
relation["admin_level"="2"]["ISO3166-1"="AT"];
relation["admin_level"="2"]["ISO3166-1"="BE"];
relation["admin_level"="2"]["ISO3166-1"="BG"];
relation["admin_level"="2"]["ISO3166-1"="HR"];
relation["admin_level"="2"]["ISO3166-1"="CY"];
relation["admin_level"="2"]["ISO3166-1"="CZ"];
relation["admin_level"="2"]["ISO3166-1"="DK"];
relation["admin_level"="2"]["ISO3166-1"="EE"];
relation["admin_level"="2"]["ISO3166-1"="FI"];
relation["admin_level"="2"]["ISO3166-1"="FR"];
relation["admin_level"="2"]["ISO3166-1"="DE"];
relation["admin_level"="2"]["ISO3166-1"="GR"];
relation["admin_level"="2"]["ISO3166-1"="HU"];
relation["admin_level"="2"]["ISO3166-1"="IE"];
relation["admin_level"="2"]["ISO3166-1"="IT"];
relation["admin_level"="2"]["ISO3166-1"="LV"];
relation["admin_level"="2"]["ISO3166-1"="LT"];
relation["admin_level"="2"]["ISO3166-1"="LU"];
relation["admin_level"="2"]["ISO3166-1"="MT"];
relation["admin_level"="2"]["ISO3166-1"="NL"];
relation["admin_level"="2"]["ISO3166-1"="PL"];
relation["admin_level"="2"]["ISO3166-1"="PT"];
relation["admin_level"="2"]["ISO3166-1"="RO"];
relation["admin_level"="2"]["ISO3166-1"="SK"];
relation["admin_level"="2"]["ISO3166-1"="SI"];
relation["admin_level"="2"]["ISO3166-1"="ES"];
relation["admin_level"="2"]["ISO3166-1"="SE"];
);
out body;
>;
out skel qt;
2025-07-14 00:56:30,244 - pipeline - INFO - Making Overpass API request (attempt 1/3)
2025-07-14 00:56:35,281 - pipeline - INFO - Overpass API request successful
2025-07-14 00:56:36,687 - pipeline - INFO - Found 27 countries in Overpass response
2025-07-14 00:56:36,709 - pipeline - DEBUG - Created geometry for FR
2025-07-14 00:56:36,710 - pipeline - WARNING - Could not create geometry for SK
2025-07-14 00:56:36,712 - pipeline - DEBUG - Created geometry for AT
2025-07-14 00:56:36,712 - pipeline - WARNING - Could not create geometry for HU
2025-07-14 00:56:36,713 - pipeline - DEBUG - Created geometry for PL
2025-07-14 00:56:36,713 - pipeline - WARNING - Could not create geometry for DK
2025-07-14 00:56:36,714 - pipeline - DEBUG - Created geometry for DE
2025-07-14 00:56:36,714 - pipeline - DEBUG - Created geometry for CZ
2025-07-14 00:56:36,714 - pipeline - DEBUG - Created geometry for BE
2025-07-14 00:56:36,714 - pipeline - WARNING - Could not create geometry for SE
2025-07-14 00:56:36,715 - pipeline - WARNING - Could not create geometry for FI
2025-07-14 00:56:36,715 - pipeline - WARNING - Could not create geometry for IE
2025-07-14 00:56:36,717 - pipeline - WARNING - Could not create geometry for LV
2025-07-14 00:56:36,717 - pipeline - WARNING - Could not create geometry for LT
2025-07-14 00:56:36,717 - pipeline - WARNING - Could not create geometry for EE
2025-07-14 00:56:36,718 - pipeline - WARNING - Could not create geometry for RO
2025-07-14 00:56:36,718 - pipeline - WARNING - Could not create geometry for BG
2025-07-14 00:56:36,718 - pipeline - WARNING - Could not create geometry for GR
2025-07-14 00:56:36,719 - pipeline - WARNING - Could not create geometry for HR
2025-07-14 00:56:36,733 - pipeline - WARNING - Could not create geometry for SI
2025-07-14 00:56:36,733 - pipeline - WARNING - Could not create geometry for PT
2025-07-14 00:56:36,734 - pipeline - WARNING - Could not create geometry for CY
2025-07-14 00:56:36,734 - pipeline - WARNING - Could not create geometry for MT
2025-07-14 00:56:36,735 - pipeline - DEBUG - Created geometry for IT
2025-07-14 00:56:36,735 - pipeline - DEBUG - Created geometry for ES
2025-07-14 00:56:36,735 - pipeline - WARNING - Could not create geometry for LU
2025-07-14 00:56:36,736 - pipeline - DEBUG - Created geometry for NL
2025-07-14 00:56:36,742 - pipeline - INFO - Successfully created GeoDataFrame with 9 countries
2025-07-14 00:56:36,901 - pipeline - INFO - Saving 9 countries to database
2025-07-14 00:56:36,920 - pipeline - INFO - Loaded 9 records into countries in 0.02s
2025-07-14 00:56:36,920 - pipeline - INFO - Successfully saved 9 countries to database
2025-07-14 00:56:36,921 - pipeline - INFO - Fetched and saved 9 countries
2025-07-14 00:56:36,925 - pipeline - INFO - Stage 4: Spatial Association
2025-07-14 00:56:37,002 - pipeline - INFO - Found 9 countries with valid boundaries
2025-07-14 00:56:37,002 - pipeline - INFO - Geometry column created with 9 rows
2025-07-14 00:56:37,002 - pipeline - INFO - Geometry column data type: object
2025-07-14 00:56:37,015 - pipeline - INFO - GeoDataFrame created with 9 rows and geometry column: geometry
2025-07-14 00:56:37,015 - pipeline - INFO - Starting spatial association of soil samples with countries
2025-07-14 00:56:37,016 - pipeline - INFO - Creating point geometries for soil samples
2025-07-14 00:56:37,330 - pipeline - INFO - Created 7012 point geometries
2025-07-14 00:56:37,330 - pipeline - INFO - Performing spatial join (point-in-polygon)
2025-07-14 00:56:38,212 - pipeline - INFO - Spatial join results:
2025-07-14 00:56:38,228 - pipeline - INFO -   - Total samples: 7012
2025-07-14 00:56:38,228 - pipeline - INFO -   - Associated: 6389
2025-07-14 00:56:38,228 - pipeline - INFO -   - Unassigned: 623
2025-07-14 00:56:38,228 - pipeline - WARNING - 623 samples could not be assigned to any country
2025-07-14 00:56:38,228 - pipeline - INFO - Spatial association completed in 1.21s
2025-07-14 00:56:38,228 - pipeline - INFO - Associated 6389 soil samples with countries
2025-07-14 00:56:38,252 - pipeline - INFO - Actually updated 6389 soil samples in database
2025-07-14 00:56:38,274 - pipeline - INFO - Updated country assignments for 6389 soil samples
2025-07-14 00:56:38,274 - pipeline - INFO - Updated 6389 soil samples with country assignments
2025-07-14 00:56:40,631 - pipeline - INFO - Sample counts per country: {'IT': 388, 'CZ': 22, 'PL': 166, 'DE': 220, 'FR': 136, 'NL': 341, 'BE': 4929, 'ES': 187, 'AT': 0}
2025-07-14 00:56:40,631 - pipeline - INFO - Spatial association validation:
2025-07-14 00:56:40,631 - pipeline - INFO -   - Coverage: 91.1%
2025-07-14 00:56:40,631 - pipeline - INFO -   - Countries with samples: 8
2025-07-14 00:56:40,631 - pipeline - INFO -   - Unassigned samples: 623
2025-07-14 00:56:40,631 - pipeline - INFO - Spatial association coverage: 91.1%
2025-07-14 00:56:40,631 - pipeline - INFO - Stage 5: Clustering
2025-07-14 00:56:40,662 - pipeline - INFO - Starting spatial clustering of soil samples within countries
2025-07-14 00:56:40,671 - pipeline - INFO - Found 8 countries for clustering
2025-07-14 00:56:42,480 - pipeline - INFO - Country Italia: 7 clusters created
2025-07-14 00:56:43,055 - pipeline - INFO - Country Česko: 3 clusters created
2025-07-14 00:56:44,351 - pipeline - INFO - Country Polska: 4 clusters created
2025-07-14 00:56:45,685 - pipeline - INFO - Country Deutschland: 3 clusters created
2025-07-14 00:56:47,020 - pipeline - INFO - Country France (terres): 4 clusters created
2025-07-14 00:56:48,487 - pipeline - INFO - Country Nederland: 4 clusters created
2025-07-14 00:56:53,685 - pipeline - INFO - Country België / Belgique / Belgien: 11 clusters created
2025-07-14 00:56:55,429 - pipeline - INFO - Country España: 4 clusters created
2025-07-14 00:56:55,431 - pipeline - INFO - Clustering completed in 14.77s
2025-07-14 00:56:55,432 - pipeline - INFO - Created 40 clusters across 8 countries
2025-07-14 00:56:55,446 - pipeline - INFO - Stored 40 clusters
2025-07-14 00:56:55,447 - pipeline - INFO - Stored 40 clusters in database
2025-07-14 00:56:55,554 - pipeline - INFO - Updated cluster assignments for 6389 soil samples
2025-07-14 00:56:55,555 - pipeline - INFO - Updated 6389 soil samples with cluster assignments
2025-07-14 00:56:55,556 - pipeline - INFO - Clustering validation:
2025-07-14 00:56:55,556 - pipeline - INFO -   - Countries clustered: 8
2025-07-14 00:56:55,557 - pipeline - INFO -   - Total clusters: 40
2025-07-14 00:56:55,557 - pipeline - INFO -   - Samples clustered: 6389
2025-07-14 00:56:55,558 - pipeline - INFO -   - Coverage: 91.1%
2025-07-14 00:56:55,558 - pipeline - INFO -   - Avg cluster size: 159.7
2025-07-14 00:56:55,558 - pipeline - INFO - Clustering coverage: 91.1%
2025-07-14 00:56:55,562 - pipeline - INFO - Stage 5: Statistical Analysis
2025-07-14 00:56:55,640 - pipeline - INFO - Starting statistical analysis with single_cluster sampling
2025-07-14 00:56:55,641 - pipeline - INFO - Target sample size: 50, Min samples: 10
2025-07-14 00:56:55,648 - pipeline - INFO - Found 8 countries with samples
2025-07-14 00:56:55,877 - pipeline - INFO - Single cluster sampling: 50 samples from cluster 4
2025-07-14 00:56:55,881 - pipeline - INFO - Country Italia: 50 samples, SOC mean: 0.935%, Clay mean: 0.178
2025-07-14 00:56:55,883 - pipeline - DEBUG - Random sampling: 22 samples selected
2025-07-14 00:56:55,884 - pipeline - INFO - Country Česko: 22 samples, SOC mean: 2.085%, Clay mean: 0.218
2025-07-14 00:56:56,068 - pipeline - INFO - Single cluster sampling: 47 samples from largest cluster (cluster 0)
2025-07-14 00:56:56,070 - pipeline - INFO - Country Polska: 47 samples, SOC mean: 1.225%, Clay mean: 0.180
2025-07-14 00:56:56,257 - pipeline - INFO - Single cluster sampling: 50 samples from cluster 1
2025-07-14 00:56:56,261 - pipeline - INFO - Country Deutschland: 50 samples, SOC mean: 4.659%, Clay mean: 0.256
2025-07-14 00:56:56,451 - pipeline - INFO - Single cluster sampling: 50 samples from cluster 0
2025-07-14 00:56:56,454 - pipeline - INFO - Country France (terres): 50 samples, SOC mean: 2.381%, Clay mean: 0.222
2025-07-14 00:56:56,672 - pipeline - INFO - Single cluster sampling: 50 samples from cluster 0
2025-07-14 00:56:56,677 - pipeline - INFO - Country Nederland: 50 samples, SOC mean: 0.497%, Clay mean: 0.162
2025-07-14 00:56:56,845 - pipeline - INFO - Single cluster sampling: 50 samples from cluster 9
2025-07-14 00:56:56,847 - pipeline - INFO - Country België / Belgique / Belgien: 50 samples, SOC mean: 0.796%, Clay mean: 0.182
2025-07-14 00:56:57,030 - pipeline - INFO - Single cluster sampling: 50 samples from cluster 0
2025-07-14 00:56:57,030 - pipeline - INFO - Country España: 50 samples, SOC mean: 0.507%, Clay mean: 0.156
2025-07-14 00:56:57,030 - pipeline - INFO - Statistical analysis completed in 1.39s
2025-07-14 00:56:57,036 - pipeline - INFO - Processed 8 countries
2025-07-14 00:56:57,044 - pipeline - INFO - Stored 8 analysis results
2025-07-14 00:56:57,044 - pipeline - INFO - Stored 8 analysis results
2025-07-14 00:56:57,044 - pipeline - INFO - Summary report generated:
2025-07-14 00:56:57,044 - pipeline - INFO -   - Countries analyzed: 8
2025-07-14 00:56:57,044 - pipeline - INFO -   - Total samples: 369
2025-07-14 00:56:57,044 - pipeline - INFO -   - Overall SOC mean: 1.605%
2025-07-14 00:56:57,044 - pipeline - INFO -   - Overall clay fraction mean: 0.193
2025-07-14 00:56:57,044 - pipeline - INFO - Analysis summary: 8 countries, 369 samples
2025-07-14 00:56:57,044 - pipeline - INFO - Results validation:
2025-07-14 00:56:57,044 - pipeline - INFO -   - Total results: 8
2025-07-14 00:56:57,048 - pipeline - INFO -   - Countries with zero samples: 0
2025-07-14 00:56:57,048 - pipeline - INFO -   - Countries with low samples: 0
2025-07-14 00:56:57,048 - pipeline - INFO -   - Anomalous SOC values: 0
2025-07-14 00:56:57,048 - pipeline - INFO -   - Anomalous clay values: 0
2025-07-14 00:56:57,048 - pipeline - INFO - Stage 6: Generate Reports
2025-07-14 00:56:57,051 - pipeline - INFO - Report generated: output\pipeline_report_pipeline_20250714_005628.txt
2025-07-14 00:56:57,051 - pipeline - INFO - Pipeline completed successfully in 28.30s
2025-07-14 00:56:57,051 - pipeline - INFO - Pipeline cleanup completed
